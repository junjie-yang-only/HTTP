https://juejin.im/post/5af557a3f265da0b9265a498#heading-30


两台计算机之间的通信是通过 TCP/IP 协议在因特网上进行的。

TCP：传输控制协议
IP：网际协议

#### TCP：应用程序之间的通信

TCP确保数据包以正确的次序到达，并且尝试确认数据包内的内容没有改变。TCP 在 IP 地址之上引端口，允许计算机通过网络提供各种服务。

当应用程序希望通过 TCP 与另一个应用程序通信时，会发送一个通信请求。这个请求必须被送到一个确切的地址。在“双方握手”之后，TCP 将在两个应用程序之间建立一个全双工的通信，占用两个计算机之间整个的通行线路。TCP 用于从应用程序到网络的数据传输控制。TCP 负责在数据传送之前将它们分割为 IP 包，然后在它们到达的时候将它们重组。

> TCP 负责应用软件和网络软件之间的通信。IP 负责计算机之间的通信。TCP 负责将数据分割并装入 IP 包，IP 负责将包发送到接受者，传输过程要经 IP 路由器负责根据通信量、网络中的错误或者其他参数来进行正确的寻址，然后在它们到达的时候重新组合它们。

#### IP：计算机之间的通信

IP 协议是计算机用来相互识别的通信的一种机制，每台计算机都有一个 IP 用来在 Internet 上标识这台机器。IP 负责在因特网上发送和接收数据包。通过 IP，消息或其他数据被分为小的独立的包，并通过因特网在计算机之间传送。IP 负责将每一个包路由至它的目的地。

IP 协议仅仅是允许计算机相互发消息，但它并不检查消息是否以发送的次序达到而且没有损坏（只检查关键的头数据）。为了提供消息检验功能，直接在 IP 协议上设计了传输控制协议 TCP。

#### HTTP的概念

> 是一种用于分布式、协作试和超媒体信息系统的应用层协议，HTTP 是万维网的数据通信的基础。设计 HTTP 最初的目的是为了提供一种发布和接收 HTML 页面的方法。通过 HTTP 或者 HTTPS 协议请求的资源由统一资源标识符来标识。

HTTP  是一个基于 TCP 实现的应用层协议。

HTTP 是一个无状态的协议。无状态是指客户端和服务器之间不需要建立持久的连接，这意味着当一个客户端向服务器发出请求，然后服务器返回响应，连接就关闭了，在服务端不保留连接的有关信息。HTTP 遵循请求/应答模型。

#### HTTP 工作过程

1. 地址解析

客户端请求页面： http://localhost.com:8080/index.htm

解析结果：
（1）协议名：http
（2）主机名：localhost.com
（3）端口：8080
（4）对象路径：/index.htm

通过域名系统 DNS 解析域名 localhost.com 得到主机的 IP地址

2. 封装 HTTP 请求包

把以上部分结合主机自己的信息，封装成一个 HTTP 请求数据包

3. 封装成 TCP 包，建立 TCP 连接（TCP 的三次握手）

在 HTTP 工作开始之前，客户机（web 浏览器）首先通过网络和服务器建立连接，该连接是通过 TCP 来完成的，该协议与 IP 协议共同构建 Internet，即著名的 TCP/IP 协议族。因为 HTTP（应用层） 比 TCP（传输层） 更高层次的应用层协议，只有底层协议建立之后才能进行更高层协议的连接，因此，首先建立 TCP 协议，一般 TCP 连接的端口号是 80，这里是 8080 端口。

4. 客户机发送请求命令

建立连接之后，客户端发送一个请求给服务器，请求方式的格式为：统一资源标识符（URL）、协议版本号，后面是 MIME 信息包括请求修饰符、客户机信息和可内容。

5. 服务器响应

服务器接到请求后，给予相应的响应信息，其格式为一个状态行，包括信息的协议版本号、一个成功或错误的代码，后面是 MIME 信息包括服务器信息、实体信息和可能的内容。

实体消息是服务器向浏览器发送头信息后，他会发送一个空白行来表示头信息的发送到此为结束，接着，他就以 Content-Type 应答头信息所描述的格式发送用户所请求的实际数据。

6. 服务器关闭 TCP 连接

一般情况下，一旦 Web 服务器向浏览器发送了请求数据，就要关闭 TCP连接，然后如果浏览器或者服务器在头信息加入了这行代码

```Connection:keep-alive	```

TCP 连接在发送后仍然保持打开状态，于是，浏览器可以继续通过相同的连接发送请求。保持连接节省为每个请求建立新连接所需的时间，还节约了网络带宽。

#### HTTP  工作过程中用到的概念

报文格式（请求和响应）

请求报文格式：

```
请求方法 URL HTTP/版本号
请求首部字段（可选）
空行
body（只对 POST 请求有效）

例子：

GET http://m.baidu.com/ HTTP/1.1
Host m.baidu.com
Connection keep-Alive
... // 其他 header

key=iOS
```

响应报文格式：

```
HTTP/版本号 返回码 返回码描述
应答首部字段（可选）
空行
body

HTTP/1.1 200 OK 
Content-Type text/html;charset=UTF-8
... // 其他 header

```